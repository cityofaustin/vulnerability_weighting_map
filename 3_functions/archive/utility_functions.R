`%notin%` <- function(lhs, rhs) !(lhs %in% rhs)

range01 <- function(x, ...){(x - min(x, ...)) / (max(x, ...) - min(x, ...))}

## Paste function that skips NA values
paste3 <- function(...,sep=", ") {
  L <- list(...)
  L <- lapply(L,function(x) {x[is.na(x)] <- ""; x})
  ret <-gsub(paste0("(^",sep,"|",sep,"$)"),"",
             gsub(paste0(sep,sep),sep,
                  do.call(paste,c(L,list(sep=sep)))))
  is.na(ret) <- ret==""
  ret
}

`%then%` <- `%||%` #shiny:::`%OR%`

##### Determine and input target region's FIPS/CBSA codes #####
get_counties_from_cbsa <- function(cbsa_code) {
  cbsa_code <- as.numeric(cbsa_code)
  county2msa %>%
    filter(cbsa == cbsa_code) %>%
    pull(county)
}


get_states_from_stcnty_fips <- function(counties){
  counties %>%
    as.data.frame() %>%
    setNames("stcnty") %>%
    mutate(st = substr(stcnty, 1, 2)) %>%
    distinct(st) %>%
    pull(st)
}